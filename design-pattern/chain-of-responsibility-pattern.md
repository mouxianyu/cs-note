# 责任链模式

责任链模式是一种行为型设计模式，它允许将请求沿着一个处理者链进行传递，直到有一个处理者能够处理该请求为止

> 每个对象都有责任决定是自己处理请求还是将请求传递给链中的下一个对象。
>
> 责任链是不能所有对象都处理，而是某个对象对其进行负责处理。（因此 Gulp 不能算一种责任链）

## 主要特点和优点

-   **链的结构**：责任链由一系列的处理者对象组成，形成一个链。每个处理者都有一个处理请求的方法。
-   **请求传递**：请求从链的头部开始传递，逐个经过每个处理者。如果一个处理者能够处理请求，它就会处理并结束链的执行；否则，它会将请求传递给下一个处理者。
-   **灵活性**：责任链模式使得系统具有很高的灵活性，可以动态地添加、删除或修改处理者，而不需要修改请求的发送者或接收者的代码。
-   **解耦**：请求的发送者和接收者之间实现了解耦，它们不需要直接相互引用，只需要与链中的处理者进行交互。

## 应用场景

-   **处理请求的顺序**：当有多个处理者需要按照特定的顺序处理请求时，可以使用责任链模式。
-   **权限控制**：可以根据不同的权限级别设置不同的处理者，实现权限的控制和管理。
-   **日志记录**：将日志记录的处理者组成一个责任链，可以按照不同的级别和类型进行日志记录。
-   **异常处理**：在异常处理中，可以使用责任链模式来处理不同类型的异常。

## Koa 洋葱模型

Koa 洋葱模型是一种中间件处理机制，它借鉴了**责任链模式**的思想。

在 Koa 中，中间件函数形成一个类似于洋葱的结构，每个中间件函数都可以对请求进行处理，并在处理完成后将控制权传递给下一个中间件函数。

## Nestjs 管道

NestJS 的管道（Pipe）可以被看作是一种**责任链模式**的实现。

在 NestJS 中，管道用于在请求处理的过程中对输入数据进行转换、验证、格式化等操作。管道可以看作是一系列处理步骤的链接，每个管道都可以对输入数据进行处理，并将处理后的数据传递给下一个管道。

> 洋葱模型和 Nestjs 管道严格意义上也不能算是责任链，因为不同中间件、不同管道可能都会处理，而不是某个对其负责，进行处理（可能是责任链，也可能不是）
