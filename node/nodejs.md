# NodeJS

Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境。

## 特点

-   事件驱动：Node.js 使用事件驱动架构，可以处理大量并发连接，适合构建实时应用。
-   非阻塞 I/O 模型：Node.js 采用非阻塞 I/O 模型，即使在执行 I/O 操作时也不会阻塞其他操作。
-   单线程：虽然 Node.js 在单个线程上运行，但它通过事件循环和回调函数来管理并发。
-   跨平台：Node.js 可以在多个平台上运行，包括 Windows、Linux 和 macOS。
-   适用于构建各种应用：Node.js 不仅适用于 Web 服务器，还可以用于构建：
    -   Web 服务器和 Web 应用
    -   实时通信应用（如聊天室）
    -   命令行工具
    -   数据流处理
    -   网络服务和 APIs

## 为什么要用 V8

V8 主要使用 C++编写的

-   **高性能**：V8 引擎具有出色的执行速度和性能，能够高效地运行 JavaScript 代码。
-   **成熟与稳定**：V8 引擎经过多年的发展和优化，已经非常成熟和稳定，可靠性高。
-   **与 JavaScript 语言的兼容性**：V8 引擎是专门为 JavaScript 设计的，与 Node.js 所使用的 JavaScript 语言完美契合，能够充分发挥 JavaScript 的特性。
-   **广泛的生态支持**：V8 引擎在业界有广泛的应用和支持，相关的技术和资源丰富。
-   **垃圾回收**：V8 拥有一个高效的垃圾回收机制，它可以自动管理内存，减少内存泄漏的风险，这对于长时间运行的服务器端应用尤其重要。
-   **多线程支持**：虽然 Node.js 在单个线程上运行 JavaScript 代码，但 V8 引擎支持多线程，这使得 Node.js 可以通过工作线程（worker threads）模块来利用多核处理器的优势。
-   **C++ 接口**：V8 提供了 C++ 接口，这使得 Node.js 能够轻松地与 C++ 扩展进行交互，从而扩展其功能。

## 其他 Javascript 运行时

### Deno

Deno 是一个简单、先进且安全的 `JavaScript` 和 `TypeScript` 运行时环境，其基于 `V8` 引擎并采用 `Rust` 编程语言构建。

1. 默认安全设置。除非 显式开启，否则不能访问文件、网络，也不能访问运行环境。
2. 天生支持 TypeScript。
3. 只有一个唯一的可执行文件。
4. 自带实用工具，例如依赖检查器 (deno info) 和代码格式化工具 (deno fmt)。

### Bun

"Bun" 是用于 `JavaScript` 和 `TypeScript` 应用程序的一站式工具包。它以一个名为 bun 的单一可执行文件的形式发布。

在其核心是 Bun 运行时，它是一个快速的 JavaScript 运行时，设计成可替代 Node.js。它是用 `Zig` 编写的，并在底层由 `JavaScriptCore` 驱动（ `JavaScriptCore` 是 Apple 开发的 `Webkit` 的一部分），大大减少了启动时间和内存使用。

1. 单一二进制文件：Bun 旨在提供一个轻量级且快速的体验，所有功能都包含在一个单一的可执行文件中。
2. 快速的启动时间：由于其设计和实现，Bun 可以提供快速的应用程序启动时间。
3. 内置的打包器：Bun 包括了一个内置的打包器，可以快速打包 JavaScript 代码和资源。
4. 支持 TypeScript：Bun 支持 TypeScript 并且可以开箱即用地运行 TypeScript 代码。
5. 性能优化：Bun 的设计注重性能，包括但不限于快速的文件系统操作和网络请求。
6. 热重载：Bun 提供了热重载支持，可以在开发过程中即时更新应用程序。

### Nodejs、Deno、Bun 对比

| 特性/运行时     | Node.js                         | Deno                                  | Bun                           |
| --------------- | ------------------------------- | ------------------------------------- | ----------------------------- |
| 创建者          | Ryan Dahl（Google Chrome 团队） | Ryan Dahl                             | Jarred Sumner                 |
| 首次发布        | 2009 年                         | 2018 年                               | 2021 年                       |
| JavaScript 引擎 | V8 (Chrome)                     | V8 (Chrome)                           | JavaScriptCore (Safari)       |
| 编程语言        | C++                             | Rust                                  | Zig                           |
| 安全性          | 不是默认沙箱，需要额外配置      | 默认沙箱执行                          | 不是默认沙箱，需要额外配置    |
| 生态系统        | 成熟、广泛                      | 相对较小、仍在发展                    | 初级阶段，正在发展            |
| 第三方库        | 丰富                            | 有限                                  | 较少，但正在增长              |
| 内置模块        | 是，通过 require                | 通过 import（CommonJS 和 ES Modules） | 是，通过 import（ES Modules） |
| 包管理器        | npm                             | 无，使用 URL 导入                     | bunx，内置快速包管理器        |
| TypeScript 支持 | 需要 ts-node 等工具             | 原生支持                              | 原生支持                      |
| 网络平台 API    | 有限/实验性                     | 稳定的原生支持                        | 稳定的原生支持                |
| 性能            | 经过优化，适用于多种场景        | 优化的 CPU 和内存使用                 | 突出的性能，快速启动和执行    |
| 社区支持        | 大型活跃社区                    | 活跃的社区，但相对较小                | 较小的社区，增长中            |

## Nodejs 相对于其他服务端的优点

1. **事件驱动和非阻塞 I/O 模型**：Node.js 采用事件驱动和非阻塞 I/O 模型，这使得其非常适合处理大量并发连接，如实时通信应用。
2. **单线程**：尽管 Node.js 在单个线程上运行，但它通过事件循环和回调函数来处理并发，避免了多线程编程中的复杂性和同步问题。
3. **跨平台**：Node.js 可以在多种操作系统上运行，包括 Windows、Linux 和 macOS。
4. **轻量且易于部署**：资源占用少，启动速度快，适合快速开发和部署应用，适合构建微服务架构
5. **实时应用开发**：非常适合开发实时通信、实时数据处理等应用。
6. **统一的编程语言**：前端和后端使用同一种语言（JavaScript），这可以减少上下文切换，提高开发效率。
7. **丰富的生态系统**：拥有庞大的开源社区和丰富的模块资源，方便快速构建各种应用。
